<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>JAMB Mastermind 300+ - School Testing Platform</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css">
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22 fill=%22%23004a99%22>ðŸŽ“</text></svg>">
    
    <style>
        /* === SCHOOL MODE STYLES === */
        .school-mode-banner {
            background: linear-gradient(90deg, #004a99, #0066cc);
            color: white;
            padding: 15px 20px;
            text-align: center;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            z-index: 10000;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }
        
        .school-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .school-badge {
            background: #ffc107;
            color: #000;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .admin-panel {
            position: fixed;
            top: 60px;
            right: 20px;
            background: rgba(30, 30, 30, 0.95);
            border: 2px solid #28a745;
            border-radius: 15px;
            padding: 20px;
            width: 350px;
            z-index: 9999;
            display: none;
            backdrop-filter: blur(10px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        
        .admin-controls {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .admin-btn {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            color: white;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: background 0.3s;
        }
        
        .admin-btn:hover {
            background: rgba(40, 167, 69, 0.2);
            border-color: #28a745;
        }
        
        .admin-btn.primary {
            background: linear-gradient(135deg, #28a745, #20c997);
            border: none;
        }
        
        .admin-btn.danger {
            background: linear-gradient(135deg, #d9534f, #c9302c);
            border: none;
        }
        
        .test-settings {
            background: rgba(255,255,255,0.05);
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
        }
        
        .setting-group {
            margin-bottom: 15px;
        }
        
        .setting-label {
            display: block;
            color: #b0b0b0;
            font-size: 0.9rem;
            margin-bottom: 5px;
        }
        
        .setting-input {
            width: 100%;
            padding: 10px;
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 5px;
            color: white;
        }
        
        .setting-input:focus {
            outline: none;
            border-color: #28a745;
        }
        
        /* === COMPREHENSIVE TEST SYSTEM === */
        .comprehensive-test {
            display: none;
            position: fixed;
            top: 60px;
            left: 0;
            width: 100%;
            height: calc(100% - 60px);
            background: linear-gradient(135deg, #0c2461, #1e3799);
            z-index: 9998;
            overflow-y: auto;
            padding: 20px;
        }
        
        .test-controls-bar {
            background: rgba(255,255,255,0.05);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .test-info {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .info-item {
            display: flex;
            flex-direction: column;
        }
        
        .info-label {
            color: #b0b0b0;
            font-size: 0.8rem;
        }
        
        .info-value {
            color: white;
            font-weight: bold;
            font-size: 1.1rem;
        }
        
        .section-navigation {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin: 20px 0;
        }
        
        .section-btn {
            padding: 10px 20px;
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            color: white;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .section-btn:hover {
            background: rgba(255,255,255,0.15);
        }
        
        .section-btn.active {
            background: linear-gradient(135deg, #004a99, #0066cc);
            border-color: #004a99;
        }
        
        .section-btn.completed {
            background: rgba(40, 167, 69, 0.3);
            border-color: #28a745;
        }
        
        .review-panel {
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .review-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(40px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }
        
        .review-btn {
            width: 40px;
            height: 40px;
            border-radius: 5px;
            border: none;
            cursor: pointer;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .review-btn.unanswered {
            background: rgba(255,255,255,0.1);
            color: white;
        }
        
        .review-btn.answered {
            background: rgba(40, 167, 69, 0.3);
            color: white;
            border: 2px solid #28a745;
        }
        
        .review-btn.marked {
            background: rgba(255, 193, 7, 0.3);
            color: white;
            border: 2px solid #ffc107;
        }
        
        .review-btn.current {
            background: linear-gradient(135deg, #004a99, #0066cc);
            color: white;
            border: 2px solid #004a99;
        }
        
        /* === CERTIFICATE SYSTEM === */
        .certificate-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.95);
            z-index: 10001;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .certificate {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            width: 100%;
            max-width: 800px;
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            border: 15px solid #004a99;
            position: relative;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
        }
        
        .certificate::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('https://www.transparenttextures.com/patterns/white-texture.png');
            opacity: 0.1;
            pointer-events: none;
        }
        
        .certificate-header {
            border-bottom: 3px solid #004a99;
            padding-bottom: 20px;
            margin-bottom: 30px;
        }
        
        .certificate-title {
            font-size: 2.5rem;
            color: #004a99;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .certificate-subtitle {
            font-size: 1.2rem;
            color: #666;
        }
        
        .certificate-body {
            margin: 30px 0;
        }
        
        .student-name {
            font-size: 2.8rem;
            color: #004a99;
            font-weight: bold;
            margin: 20px 0;
            text-transform: uppercase;
        }
        
        .achievement-text {
            font-size: 1.3rem;
            color: #333;
            line-height: 1.6;
            margin: 20px 0;
        }
        
        .score-display {
            font-size: 4rem;
            color: #28a745;
            font-weight: bold;
            margin: 20px 0;
        }
        
        .certificate-footer {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 2px solid #ccc;
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .signature {
            text-align: center;
        }
        
        .signature-line {
            width: 200px;
            height: 1px;
            background: #333;
            margin: 20px auto 10px;
        }
        
        /* === ANALYTICS DASHBOARD === */
        .analytics-dashboard {
            display: none;
            position: fixed;
            top: 60px;
            left: 0;
            width: 100%;
            height: calc(100% - 60px);
            background: linear-gradient(135deg, #0c2461, #1e3799);
            z-index: 9998;
            overflow-y: auto;
            padding: 20px;
        }
        
        .analytics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .analytics-card {
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .chart-container {
            height: 200px;
            margin: 20px 0;
            position: relative;
        }
        
        .student-list {
            max-height: 300px;
            overflow-y: auto;
        }
        
        .student-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .student-score {
            background: #28a745;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: bold;
        }
        
        /* Existing styles remain the same, adding only what's necessary to avoid duplication */
        /* ... [Previous CSS styles remain unchanged] ... */
        
        /* === RESPONSIVE DESIGN === */
        @media print {
            .school-mode-banner,
            .run-button-container,
            .admin-panel,
            .test-controls-bar {
                display: none !important;
            }
            
            .certificate {
                border: none;
                box-shadow: none;
                max-width: 100%;
            }
        }
        
        @media (max-width: 768px) {
            .school-mode-banner {
                flex-direction: column;
                gap: 10px;
                padding: 10px;
            }
            
            .admin-panel {
                width: calc(100% - 40px);
                right: 10px;
                left: 10px;
            }
            
            .certificate {
                padding: 20px;
            }
            
            .student-name {
                font-size: 2rem;
            }
            
            .score-display {
                font-size: 3rem;
            }
            
            .test-controls-bar {
                flex-direction: column;
                align-items: flex-start;
            }
        }
        
        /* Rest of your existing styles continue below */
        /* ... [All previous CSS styles] ... */
        
        /* Quick fix to ensure everything fits */
        * { 
            box-sizing: border-box; 
            margin: 0;
            padding: 0;
            -webkit-tap-highlight-color: transparent; 
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #0c2461, #1e3799);
            color: var(--text-main);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Add margin-top for content below school banner */
        .landing-page,
        .app-interface,
        .practice-mode,
        .comprehensive-test,
        .analytics-dashboard {
            margin-top: 60px;
        }

        :root {
            --primary: #004a99;
            --primary-light: rgba(0, 74, 153, 0.1);
            --secondary: #28a745;
            --secondary-light: rgba(40, 167, 69, 0.1);
            --accent: #ffc107;
            --danger: #d9534f;
            --dark: #121212;
            --card-bg: #1e1e1e;
            --card-border: #333;
            --text-main: #ffffff;
            --text-dim: #b0b0b0;
            --success: #28a745;
        }
    </style>
</head>
<body>
    <!-- ========== SCHOOL MODE BANNER ========== -->
    <div class="school-mode-banner" id="schoolBanner">
        <div class="school-info">
            <i class="fas fa-school"></i>
            <span>SCHOOL TESTING MODE</span>
            <span class="school-badge">PRO EDITION</span>
        </div>
        <div style="display: flex; gap: 10px;">
            <button onclick="SchoolMode.toggleAdminPanel()" style="
                background: rgba(255,255,255,0.1);
                border: 1px solid rgba(255,255,255,0.3);
                color: white;
                padding: 8px 15px;
                border-radius: 5px;
                cursor: pointer;
                display: flex;
                align-items: center;
                gap: 8px;
                font-size: 14px;
            ">
                <i class="fas fa-cogs"></i>
                Admin
            </button>
            <button onclick="SchoolMode.showAnalytics()" style="
                background: linear-gradient(135deg, #28a745, #20c997);
                border: none;
                color: white;
                padding: 8px 15px;
                border-radius: 5px;
                cursor: pointer;
                display: flex;
                align-items: center;
                gap: 8px;
                font-size: 14px;
            ">
                <i class="fas fa-chart-bar"></i>
                Analytics
            </button>
        </div>
    </div>

    <!-- ========== ADMIN PANEL ========== -->
    <div class="admin-panel" id="adminPanel">
        <h3 style="color: #28a745; margin-bottom: 15px; display: flex; align-items: center; gap: 10px;">
            <i class="fas fa-user-shield"></i>
            School Admin Controls
        </h3>
        
        <div class="admin-controls">
            <button class="admin-btn primary" onclick="SchoolMode.startFullTest()">
                <i class="fas fa-play-circle"></i>
                Launch Full JAMB Test
            </button>
            
            <button class="admin-btn" onclick="SchoolMode.manageStudents()">
                <i class="fas fa-users"></i>
                Manage Students
            </button>
            
            <button class="admin-btn" onclick="SchoolMode.generateReports()">
                <i class="fas fa-file-alt"></i>
                Generate Reports
            </button>
            
            <button class="admin-btn" onclick="SchoolMode.customizeTest()">
                <i class="fas fa-sliders-h"></i>
                Customize Test Settings
            </button>
            
            <div class="test-settings">
                <div class="setting-group">
                    <label class="setting-label">Test Duration (minutes)</label>
                    <input type="number" class="setting-input" id="testDuration" value="180" min="30" max="240">
                </div>
                
                <div class="setting-group">
                    <label class="setting-label">Number of Questions</label>
                    <select class="setting-input" id="questionCount">
                        <option value="60">60 (Standard JAMB)</option>
                        <option value="120">120 (Extended)</option>
                        <option value="180">180 (Comprehensive)</option>
                    </select>
                </div>
                
                <div class="setting-group">
                    <label class="setting-label">Subjects to Include</label>
                    <select class="setting-input" id="selectedSubjects" multiple style="height: 100px;">
                        <option value="english" selected>Use of English</option>
                        <option value="math" selected>Mathematics</option>
                        <option value="physics" selected>Physics</option>
                        <option value="chemistry" selected>Chemistry</option>
                        <option value="biology" selected>Biology</option>
                        <option value="government" selected>Government</option>
                        <option value="economics" selected>Economics</option>
                        <option value="literature" selected>Literature</option>
                        <option value="commerce" selected>Commerce</option>
                        <option value="accounting" selected>Accounting</option>
                        <option value="geography" selected>Geography</option>
                        <option value="crs" selected>CRS/IRS</option>
                        <option value="history" selected>History</option>
                        <option value="french" selected>French</option>
                    </select>
                </div>
            </div>
            
            <button class="admin-btn danger" onclick="SchoolMode.resetAllData()">
                <i class="fas fa-trash-alt"></i>
                Reset All Data
            </button>
        </div>
    </div>

    <!-- ========== COMPREHENSIVE TEST MODE ========== -->
    <div class="comprehensive-test" id="comprehensiveTest">
        <div class="test-controls-bar">
            <div class="test-info">
                <div class="info-item">
                    <div class="info-label">TIME REMAINING</div>
                    <div class="info-value" id="fullTestTimer">03:00:00</div>
                </div>
                <div class="info-item">
                    <div class="info-label">QUESTIONS</div>
                    <div class="info-value"><span id="answeredCount">0</span>/<span id="totalTestQuestions">0</span></div>
                </div>
                <div class="info-item">
                    <div class="info-label">SUBJECT</div>
                    <div class="info-value" id="currentTestSubject">Use of English</div>
                </div>
                <div class="info-item">
                    <div class="info-label">SECTION</div>
                    <div class="info-value" id="currentSection">1 of 4</div>
                </div>
            </div>
            
            <div style="display: flex; gap: 10px;">
                <button onclick="FullTest.markForReview()" style="
                    background: rgba(255, 193, 7, 0.2);
                    border: 1px solid #ffc107;
                    color: #ffc107;
                    padding: 10px 20px;
                    border-radius: 5px;
                    cursor: pointer;
                    display: flex;
                    align-items: center;
                    gap: 8px;
                ">
                    <i class="fas fa-flag"></i>
                    Mark for Review
                </button>
                <button onclick="FullTest.showReviewPanel()" style="
                    background: rgba(0, 74, 153, 0.2);
                    border: 1px solid #004a99;
                    color: white;
                    padding: 10px 20px;
                    border-radius: 5px;
                    cursor: pointer;
                    display: flex;
                    align-items: center;
                    gap: 8px;
                ">
                    <i class="fas fa-list-ol"></i>
                    Review All
                </button>
                <button onclick="FullTest.submitFullTest()" style="
                    background: linear-gradient(135deg, #d9534f, #c9302c);
                    border: none;
                    color: white;
                    padding: 10px 20px;
                    border-radius: 5px;
                    cursor: pointer;
                    display: flex;
                    align-items: center;
                    gap: 8px;
                    font-weight: bold;
                ">
                    <i class="fas fa-paper-plane"></i>
                    Submit Test
                </button>
            </div>
        </div>
        
        <div class="section-navigation" id="sectionNavigation">
            <!-- Sections will be dynamically added here -->
        </div>
        
        <div class="question-container" id="fullTestQuestionContainer">
            <!-- Questions will be loaded here -->
        </div>
        
        <div class="navigation-buttons">
            <button class="nav-btn secondary" onclick="FullTest.prevQuestion()">
                <i class="fas fa-arrow-left"></i>
                Previous
            </button>
            <button class="nav-btn primary" onclick="FullTest.nextQuestion()">
                Next Question
                <i class="fas fa-arrow-right"></i>
            </button>
            <button class="nav-btn secondary" onclick="FullTest.nextSection()">
                Next Section
                <i class="fas fa-forward"></i>
            </button>
        </div>
        
        <div class="review-panel" id="reviewPanel" style="display: none;">
            <h3 style="color: white; margin-bottom: 15px;">
                <i class="fas fa-search"></i>
                Question Review
            </h3>
            <div class="review-grid" id="reviewGrid">
                <!-- Review buttons will be added here -->
            </div>
            <div style="margin-top: 20px; display: flex; gap: 15px; flex-wrap: wrap;">
                <div style="display: flex; align-items: center; gap: 8px;">
                    <div style="width: 20px; height: 20px; background: rgba(255,255,255,0.1); border-radius: 3px;"></div>
                    <span style="color: #b0b0b0; font-size: 0.9rem;">Unanswered</span>
                </div>
                <div style="display: flex; align-items: center; gap: 8px;">
                    <div style="width: 20px; height: 20px; background: rgba(40, 167, 69, 0.3); border: 2px solid #28a745; border-radius: 3px;"></div>
                    <span style="color: #b0b0b0; font-size: 0.9rem;">Answered</span>
                </div>
                <div style="display: flex; align-items: center; gap: 8px;">
                    <div style="width: 20px; height: 20px; background: rgba(255, 193, 7, 0.3); border: 2px solid #ffc107; border-radius: 3px;"></div>
                    <span style="color: #b0b0b0; font-size: 0.9rem;">Marked for Review</span>
                </div>
                <div style="display: flex; align-items: center; gap: 8px;">
                    <div style="width: 20px; height: 20px; background: linear-gradient(135deg, #004a99, #0066cc); border-radius: 3px;"></div>
                    <span style="color: #b0b0b0; font-size: 0.9rem;">Current Question</span>
                </div>
            </div>
        </div>
    </div>

    <!-- ========== ANALYTICS DASHBOARD ========== -->
    <div class="analytics-dashboard" id="analyticsDashboard">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
            <h1 style="color: white;">
                <i class="fas fa-chart-line"></i>
                School Performance Analytics
            </h1>
            <button onclick="SchoolMode.hideAnalytics()" style="
                background: rgba(255,255,255,0.1);
                border: 1px solid rgba(255,255,255,0.3);
                color: white;
                padding: 10px 20px;
                border-radius: 5px;
                cursor: pointer;
            ">
                <i class="fas fa-times"></i>
                Close
            </button>
        </div>
        
        <div class="analytics-grid">
            <div class="analytics-card">
                <h3 style="color: #ffc107; margin-bottom: 15px;">
                    <i class="fas fa-users"></i>
                    Overall Performance
                </h3>
                <div class="chart-container" id="overallChart">
                    <!-- Chart will be drawn here -->
                </div>
                <div style="color: #b0b0b0; font-size: 0.9rem; margin-top: 10px;">
                    Average Score: <span id="avgScore" style="color: #28a745; font-weight: bold;">0%</span>
                </div>
            </div>
            
            <div class="analytics-card">
                <h3 style="color: #ffc107; margin-bottom: 15px;">
                    <i class="fas fa-book"></i>
                    Subject Performance
                </h3>
                <div class="chart-container" id="subjectChart">
                    <!-- Chart will be drawn here -->
                </div>
            </div>
            
            <div class="analytics-card">
                <h3 style="color: #ffc107; margin-bottom: 15px;">
                    <i class="fas fa-trophy"></i>
                    Top Performers
                </h3>
                <div class="student-list" id="topPerformers">
                    <!-- Top students will be listed here -->
                </div>
            </div>
            
            <div class="analytics-card">
                <h3 style="color: #ffc107; margin-bottom: 15px;">
                    <i class="fas fa-clock"></i>
                    Test Statistics
                </h3>
                <div style="display: grid; gap: 10px;">
                    <div style="display: flex; justify-content: space-between;">
                        <span style="color: #b0b0b0;">Tests Taken:</span>
                        <span style="color: white; font-weight: bold;" id="totalTests">0</span>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <span style="color: #b0b0b0;">Total Students:</span>
                        <span style="color: white; font-weight: bold;" id="totalStudents">0</span>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <span style="color: #b0b0b0;">Average Time:</span>
                        <span style="color: white; font-weight: bold;" id="avgTime">0:00</span>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <span style="color: #b0b0b0;">Completion Rate:</span>
                        <span style="color: white; font-weight: bold;" id="completionRate">0%</span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="analytics-card" style="margin-top: 20px;">
            <h3 style="color: #ffc107; margin-bottom: 15px;">
                <i class="fas fa-list"></i>
                All Student Results
            </h3>
            <div class="student-list" id="allStudentsResults">
                <!-- All students will be listed here -->
            </div>
        </div>
    </div>

    <!-- ========== CERTIFICATE MODAL ========== -->
    <div class="certificate-modal" id="certificateModal">
        <div class="certificate" id="certificateContent">
            <div class="certificate-header">
                <div class="certificate-title">CERTIFICATE OF ACHIEVEMENT</div>
                <div class="certificate-subtitle">JAMB Mastermind 300+ Testing Platform</div>
            </div>
            
            <div class="certificate-body">
                <p style="color: #666; font-size: 1.1rem;">This certifies that</p>
                <div class="student-name" id="certStudentName">[STUDENT NAME]</div>
                <p class="achievement-text">
                    has successfully completed the JAMB Practice Test with outstanding performance,
                    demonstrating exceptional knowledge and readiness for university admission.
                </p>
                <div class="score-display" id="certScore">95%</div>
                <p style="color: #666; margin-top: 20px;">
                    Date: <span id="certDate">[DATE]</span> | 
                    Test ID: <span id="certTestId">[TEST ID]</span>
                </p>
            </div>
            
            <div class="certificate-footer">
                <div class="signature">
                    <div class="signature-line"></div>
                    <div style="color: #333; font-weight: bold; margin-top: 5px;">
                        Principal's Signature
                    </div>
                </div>
                <div class="signature">
                    <div class="signature-line"></div>
                    <div style="color: #333; font-weight: bold; margin-top: 5px;">
                        School Seal
                    </div>
                </div>
            </div>
        </div>
        
        <div style="margin-top: 20px; display: flex; gap: 15px; justify-content: center;">
            <button onclick="SchoolMode.printCertificate()" style="
                background: linear-gradient(135deg, #004a99, #0066cc);
                border: none;
                color: white;
                padding: 12px 25px;
                border-radius: 5px;
                cursor: pointer;
                font-weight: bold;
                display: flex;
                align-items: center;
                gap: 10px;
            ">
                <i class="fas fa-print"></i>
                Print Certificate
            </button>
            <button onclick="SchoolMode.closeCertificate()" style="
                background: rgba(255,255,255,0.1);
                border: 1px solid rgba(255,255,255,0.3);
                color: white;
                padding: 12px 25px;
                border-radius: 5px;
                cursor: pointer;
                font-weight: bold;
                display: flex;
                align-items: center;
                gap: 10px;
            ">
                <i class="fas fa-times"></i>
                Close
            </button>
        </div>
    </div>

    <!-- ========== REST OF THE APP (Previous HTML content) ========== -->
    <!-- RUN BUTTON, LANDING PAGE, PAYMENT MODAL, APP INTERFACE remain the same -->
    <!-- I'll include the essential parts but in a compact way to avoid duplication -->

    <!-- RUN BUTTON CONTAINER -->
    <div class="run-button-container">
        <button class="run-btn" id="mainRunButton">
            <i class="fas fa-play"></i>
            RUN JAMB APP
        </button>
    </div>

    <!-- LANDING PAGE -->
    <div class="landing-page" id="landingPage">
        <!-- ... existing landing page content ... -->
    </div>

    <!-- PAYMENT MODAL -->
    <div class="modal" id="paymentModal">
        <!-- ... existing payment modal ... -->
    </div>

    <!-- APP INTERFACE -->
    <div class="app-interface" id="appInterface">
        <!-- ... existing app interface ... -->
    </div>

    <!-- PRACTICE MODE (from previous version) -->
    <div class="practice-mode" id="practiceMode">
        <!-- ... existing practice mode ... -->
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
    <script>
        // ============================================
        // COMPREHENSIVE JAMB TEST DATABASE
        // ============================================
        const JAMBQuestionBank = {
            // English Language (60 questions)
            english: [
                {
                    id: 1,
                    question: "Choose the option that best completes the sentence: If I had known you were coming, I _____ a cake.",
                    options: ["would bake", "will bake", "would have baked", "will have baked"],
                    correct: 2,
                    explanation: "Third conditional for past hypothetical situations.",
                    section: "Grammar",
                    difficulty: "Medium"
                },
                {
                    id: 2,
                    question: "Identify the word that has a different stress pattern: 'education', 'application', 'demonstration', 'satisfaction'",
                    options: ["education", "application", "demonstration", "satisfaction"],
                    correct: 3,
                    explanation: "'Satisfaction' has stress on the third syllable.",
                    section: "Phonetics",
                    difficulty: "Hard"
                },
                {
                    id: 3,
                    question: "Choose the word nearest in meaning to 'MAGNANIMOUS':",
                    options: ["Generous", "Angry", "Small", "Intelligent"],
                    correct: 0,
                    explanation: "Magnanimous means generous or forgiving.",
                    section: "Lexis",
                    difficulty: "Easy"
                },
                // Add 57 more English questions...
            ],
            
            // Mathematics (60 questions)
            math: [
                {
                    id: 1,
                    question: "Simplify: (3xÂ² - 2x + 5) + (2xÂ² + 4x - 3)",
                    options: ["5xÂ² + 2x + 2", "5xÂ² + 2x + 8", "5xÂ² - 2x + 2", "xÂ² + 2x + 2"],
                    correct: 0,
                    explanation: "Combine like terms.",
                    section: "Algebra",
                    difficulty: "Easy"
                },
                {
                    id: 2,
                    question: "If logâ‚â‚€2 = 0.3010 and logâ‚â‚€3 = 0.4771, find logâ‚â‚€6",
                    options: ["0.7781", "0.6990", "0.8451", "0.9542"],
                    correct: 0,
                    explanation: "logâ‚â‚€6 = logâ‚â‚€(2Ã—3) = logâ‚â‚€2 + logâ‚â‚€3",
                    section: "Logarithms",
                    difficulty: "Medium"
                },
                // Add 58 more Math questions...
            ],
            
            // Physics (60 questions)
            physics: [
                {
                    id: 1,
                    question: "Which of these is NOT a vector quantity?",
                    options: ["Velocity", "Force", "Speed", "Acceleration"],
                    correct: 2,
                    explanation: "Speed is a scalar quantity (magnitude only).",
                    section: "Mechanics",
                    difficulty: "Easy"
                },
                // Add 59 more Physics questions...
            ],
            
            // Chemistry (60 questions)
            chemistry: [
                {
                    id: 1,
                    question: "What is the atomic number of Carbon?",
                    options: ["6", "12", "14", "16"],
                    correct: 0,
                    explanation: "Carbon has 6 protons.",
                    section: "Atomic Structure",
                    difficulty: "Easy"
                },
                // Add 59 more Chemistry questions...
            ],
            
            // Biology (60 questions)
            biology: [
                {
                    id: 1,
                    question: "Which organelle is responsible for protein synthesis?",
                    options: ["Mitochondria", "Ribosome", "Nucleus", "Golgi apparatus"],
                    correct: 1,
                    explanation: "Ribosomes synthesize proteins.",
                    section: "Cell Biology",
                    difficulty: "Easy"
                },
                // Add 59 more Biology questions...
            ],
            
            // Government (60 questions)
            government: [
                {
                    id: 1,
                    question: "The first military coup in Nigeria occurred in what year?",
                    options: ["1960", "1966", "1975", "1983"],
                    correct: 1,
                    explanation: "First military coup was January 15, 1966.",
                    section: "Political History",
                    difficulty: "Medium"
                },
                // Add 59 more Government questions...
            ],
            
            // Economics (60 questions)
            economics: [
                {
                    id: 1,
                    question: "What does GDP stand for?",
                    options: ["Gross Domestic Product", "General Domestic Price", "Gross Development Plan", "General Development Product"],
                    correct: 0,
                    explanation: "GDP = Gross Domestic Product.",
                    section: "Basic Concepts",
                    difficulty: "Easy"
                },
                // Add 59 more Economics questions...
            ],
            
            // Literature (60 questions)
            literature: [
                {
                    id: 1,
                    question: "Who wrote 'Things Fall Apart'?",
                    options: ["Wole Soyinka", "Chinua Achebe", "Chimamanda Adichie", "Ben Okri"],
                    correct: 1,
                    explanation: "Chinua Achebe wrote Things Fall Apart.",
                    section: "African Literature",
                    difficulty: "Easy"
                },
                // Add 59 more Literature questions...
            ],
            
            // Commerce (60 questions)
            commerce: [
                {
                    id: 1,
                    question: "What is the primary function of commerce?",
                    options: ["Production", "Distribution", "Consumption", "Exchange"],
                    correct: 3,
                    explanation: "Commerce facilitates exchange of goods and services.",
                    section: "Introduction",
                    difficulty: "Easy"
                },
                // Add 59 more Commerce questions...
            ],
            
            // Accounting (60 questions)
            accounting: [
                {
                    id: 1,
                    question: "The accounting equation is:",
                    options: ["Assets = Liabilities + Capital", "Assets = Liabilities - Capital", "Assets + Liabilities = Capital", "Assets - Liabilities = Expenses"],
                    correct: 0,
                    explanation: "Basic accounting equation.",
                    section: "Principles",
                    difficulty: "Easy"
                },
                // Add 59 more Accounting questions...
            ],
            
            // Geography (60 questions)
            geography: [
                {
                    id: 1,
                    question: "What is the largest desert in the world?",
                    options: ["Sahara", "Arabian", "Gobi", "Antarctic"],
                    correct: 3,
                    explanation: "Antarctic Desert is the largest.",
                    section: "Physical Geography",
                    difficulty: "Medium"
                },
                // Add 59 more Geography questions...
            ],
            
            // CRS/IRS (60 questions)
            crs: [
                {
                    id: 1,
                    question: "How many books are in the New Testament?",
                    options: ["27", "39", "66", "73"],
                    correct: 0,
                    explanation: "27 books in the New Testament.",
                    section: "Bible Knowledge",
                    difficulty: "Easy"
                },
                // Add 59 more CRS questions...
            ],
            
            // History (60 questions)
            history: [
                {
                    id: 1,
                    question: "Who was Nigeria's first President?",
                    options: ["Nnamdi Azikiwe", "Tafawa Balewa", "Obafemi Awolowo", "Ahmadu Bello"],
                    correct: 0,
                    explanation: "Nnamdi Azikiwe was first President.",
                    section: "Nigerian History",
                    difficulty: "Easy"
                },
                // Add 59 more History questions...
            ],
            
            // French (60 questions)
            french: [
                {
                    id: 1,
                    question: "What is the French word for 'book'?",
                    options: ["livre", "maison", "Ã©cole", "voiture"],
                    correct: 0,
                    explanation: "Livre means book in French.",
                    section: "Vocabulary",
                    difficulty: "Easy"
                },
                // Add 59 more French questions...
            ]
        };

        // ============================================
        // SCHOOL MODE SYSTEM
        // ============================================
        const SchoolMode = {
            isActive: true,
            currentStudents: [],
            testResults: [],
            
            init() {
                this.loadSchoolData();
                this.showSchoolBanner();
                this.setupEventListeners();
            },
            
            loadSchoolData() {
                const saved = localStorage.getItem('jamb_school_data');
                if (saved) {
                    const data = JSON.parse(saved);
                    this.currentStudents = data.students || [];
                    this.testResults = data.results || [];
                }
            },
            
            saveSchoolData() {
                const data = {
                    students: this.currentStudents,
                    results: this.testResults,
                    timestamp: new Date().toISOString()
                };
                localStorage.setItem('jamb_school_data', JSON.stringify(data));
            },
            
            showSchoolBanner() {
                document.getElementById('schoolBanner').style.display = 'flex';
                // Adjust other elements for banner space
                document.querySelectorAll('.landing-page, .app-interface, .practice-mode').forEach(el => {
                    el.style.marginTop = '60px';
                });
            },
            
            toggleAdminPanel() {
                const panel = document.getElementById('adminPanel');
                panel.style.display = panel.style.display === 'block' ? 'none' : 'block';
            },
            
            startFullTest() {
                // Hide other views
                document.getElementById('landingPage').style.display = 'none';
                document.getElementById('appInterface').style.display = 'none';
                document.getElementById('practiceMode').style.display = 'none';
                document.getElementById('adminPanel').style.display = 'none';
                
                // Show comprehensive test
                document.getElementById('comprehensiveTest').style.display = 'block';
                
                // Get test settings
                const duration = parseInt(document.getElementById('testDuration').value) || 180;
                const questionCount = parseInt(document.getElementById('questionCount').value) || 60;
                const subjects = Array.from(document.getElementById('selectedSubjects').selectedOptions)
                    .map(opt => opt.value);
                
                // Initialize full test
                FullTest.initializeTest(duration, questionCount, subjects);
                
                this.showToast('Full JAMB test launched!', 'success');
            },
            
            manageStudents() {
                const count = prompt("How many students will take the test?", "30");
                if (count && !isNaN(count)) {
                    this.generateStudentList(parseInt(count));
                    this.showToast(`Generated ${count} student records`, 'success');
                }
            },
            
            generateStudentList(count) {
                this.currentStudents = [];
                const firstNames = ['John', 'Mary', 'David', 'Sarah', 'Michael', 'Blessing', 'Emmanuel', 'Grace', 'Daniel', 'Peace'];
                const lastNames = ['Ade', 'Bello', 'Chukwu', 'Dike', 'Eze', 'Falana', 'Gbenga', 'Hassan', 'Ibrahim', 'Joseph'];
                
                for (let i = 1; i <= count; i++) {
                    const firstName = firstNames[Math.floor(Math.random() * firstNames.length)];
                    const lastName = lastNames[Math.floor(Math.random() * lastNames.length)];
                    const studentId = `STU${i.toString().padStart(3, '0')}`;
                    
                    this.currentStudents.push({
                        id: studentId,
                        name: `${firstName} ${lastName}`,
                        class: `SS${Math.floor(Math.random() * 3) + 1}`,
                        testsTaken: 0,
                        averageScore: 0
                    });
                }
                
                this.saveSchoolData();
                this.showStudentList();
            },
            
            showStudentList() {
                const list = this.currentStudents.map(student => 
                    `${student.id} - ${student.name} (${student.class})`
                ).join('\n');
                
                alert(`ðŸ“š STUDENT LIST (${this.currentStudents.length} students)\n\n${list}`);
            },
            
            generateReports() {
                if (this.testResults.length === 0) {
                    this.showToast('No test results available', 'warning');
                    return;
                }
                
                let report = `ðŸ“Š SCHOOL TEST REPORT\n`;
                report += `Generated: ${new Date().toLocaleString()}\n`;
                report += `Total Tests: ${this.testResults.length}\n`;
                report += `Total Students: ${this.currentStudents.length}\n\n`;
                
                // Calculate statistics
                const scores = this.testResults.map(r => r.score);
                const avgScore = scores.reduce((a, b) => a + b, 0) / scores.length;
                const topScore = Math.max(...scores);
                const bottomScore = Math.min(...scores);
                
                report += `ðŸ“ˆ PERFORMANCE SUMMARY\n`;
                report += `Average Score: ${avgScore.toFixed(1)}%\n`;
                report += `Highest Score: ${topScore}%\n`;
                report += `Lowest Score: ${bottomScore}%\n\n`;
                
                report += `ðŸ† TOP 5 PERFORMERS\n`;
                const topPerformers = [...this.testResults]
                    .sort((a, b) => b.score - a.score)
                    .slice(0, 5);
                
                topPerformers.forEach((result, index) => {
                    report += `${index + 1}. ${result.studentName} - ${result.score}%\n`;
                });
                
                // Show report
                alert(report);
                
                // Option to download
                if (confirm('Download report as text file?')) {
                    this.downloadReport(report);
                }
            },
            
            downloadReport(content) {
                const blob = new Blob([content], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `jamb-school-report-${new Date().toISOString().split('T')[0]}.txt`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            },
            
            customizeTest() {
                this.showToast('Test customization panel opened', 'info');
            },
            
            resetAllData() {
                if (confirm('WARNING: This will delete ALL school data including student records and test results. Continue?')) {
                    localStorage.removeItem('jamb_school_data');
                    this.currentStudents = [];
                    this.testResults = [];
                    this.showToast('All school data has been reset', 'success');
                }
            },
            
            showAnalytics() {
                document.getElementById('analyticsDashboard').style.display = 'block';
                this.updateAnalytics();
            },
            
            hideAnalytics() {
                document.getElementById('analyticsDashboard').style.display = 'none';
            },
            
            updateAnalytics() {
                // Update statistics
                document.getElementById('totalTests').textContent = this.testResults.length;
                document.getElementById('totalStudents').textContent = this.currentStudents.length;
                
                if (this.testResults.length > 0) {
                    const avgScore = this.testResults.reduce((sum, r) => sum + r.score, 0) / this.testResults.length;
                    document.getElementById('avgScore').textContent = `${avgScore.toFixed(1)}%`;
                    
                    // Update top performers list
                    const topPerformers = [...this.testResults]
                        .sort((a, b) => b.score - a.score)
                        .slice(0, 10);
                    
                    const topList = document.getElementById('topPerformers');
                    topList.innerHTML = topPerformers.map((result, index) => `
                        <div class="student-item">
                            <div>
                                <strong>${index + 1}. ${result.studentName}</strong><br>
                                <small style="color: #b0b0b0;">${result.date}</small>
                            </div>
                            <div class="student-score">${result.score}%</div>
                        </div>
                    `).join('');
                    
                    // Update all students results
                    const allResults = document.getElementById('allStudentsResults');
                    allResults.innerHTML = this.testResults.map(result => `
                        <div class="student-item">
                            <div>${result.studentName}</div>
                            <div class="student-score">${result.score}%</div>
                        </div>
                    `).join('');
                }
            },
            
            generateCertificate(studentName, score, testId) {
                document.getElementById('certStudentName').textContent = studentName;
                document.getElementById('certScore').textContent = `${score}%`;
                document.getElementById('certDate').textContent = new Date().toLocaleDateString();
                document.getElementById('certTestId').textContent = testId;
                
                document.getElementById('certificateModal').style.display = 'flex';
            },
            
            printCertificate() {
                window.print();
            },
            
            closeCertificate() {
                document.getElementById('certificateModal').style.display = 'none';
            },
            
            showToast(message, type = 'info') {
                // Simple toast implementation
                const toast = document.createElement('div');
                toast.textContent = message;
                toast.style.cssText = `
                    position: fixed;
                    bottom: 20px;
                    left: 50%;
                    transform: translateX(-50%);
                    background: ${type === 'success' ? '#28a745' : type === 'error' ? '#d9534f' : '#004a99'};
                    color: white;
                    padding: 12px 24px;
                    border-radius: 8px;
                    z-index: 10000;
                    font-weight: 600;
                    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                `;
                document.body.appendChild(toast);
                setTimeout(() => toast.remove(), 3000);
            },
            
            setupEventListeners() {
                // Close admin panel when clicking outside
                document.addEventListener('click', (e) => {
                    const panel = document.getElementById('adminPanel');
                    const toggleBtn = document.querySelector('[onclick*="toggleAdminPanel"]');
                    if (panel && !panel.contains(e.target) && !toggleBtn.contains(e.target)) {
                        panel.style.display = 'none';
                    }
                });
            }
        };

        // ============================================
        // FULL TEST SYSTEM
        // ============================================
        const FullTest = {
            currentTest: null,
            currentQuestionIndex: 0,
            userAnswers: [],
            markedQuestions: [],
            sections: [],
            currentSectionIndex: 0,
            timer: null,
            timeRemaining: 0,
            
            initializeTest(duration, questionCount, subjects) {
                this.timeRemaining = duration * 60;
                this.userAnswers = [];
                this.markedQuestions = [];
                this.currentQuestionIndex = 0;
                this.currentSectionIndex = 0;
                
                // Create test structure
                this.sections = subjects.map((subject, index) => {
                    const subjectName = this.getSubjectName(subject);
                    const questions = this.getQuestionsForSubject(subject, questionCount / subjects.length);
                    
                    return {
                        id: index + 1,
                        name: subjectName,
                        subject: subject,
                        questions: questions,
                        startIndex: index * (questionCount / subjects.length)
                    };
                });
                
                // Initialize answers array
                this.userAnswers = new Array(questionCount).fill(null);
                
                // Start timer
                this.startTimer();
                
                // Load first question
                this.loadCurrentQuestion();
                
                // Update UI
                this.updateTestInfo();
                this.createSectionNavigation();
            },
            
            getSubjectName(code) {
                const names = {
                    english: "Use of English",
                    math: "Mathematics",
                    physics: "Physics",
                    chemistry: "Chemistry",
                    biology: "Biology",
                    government: "Government",
                    economics: "Economics",
                    literature: "Literature",
                    commerce: "Commerce",
                    accounting: "Accounting",
                    geography: "Geography",
                    crs: "CRS/IRS",
                    history: "History",
                    french: "French"
                };
                return names[code] || code;
            },
            
            getQuestionsForSubject(subject, count) {
                // In a real app, this would fetch from JAMBQuestionBank
                // For demo, generate sample questions
                const questions = [];
                for (let i = 1; i <= count; i++) {
                    questions.push({
                        id: i,
                        question: `${this.getSubjectName(subject)} Sample Question ${i}`,
                        options: ["Option A", "Option B", "Option C", "Option D"],
                        correct: Math.floor(Math.random() * 4),
                        explanation: "Sample explanation",
                        section: "General",
                        difficulty: i <= count/3 ? "Easy" : i <= 2*count/3 ? "Medium" : "Hard"
                    });
                }
                return questions;
            },
            
            loadCurrentQuestion() {
                const currentSection = this.sections[this.currentSectionIndex];
                const question = currentSection.questions[this.currentQuestionIndex - currentSection.startIndex];
                
                if (!question) return;
                
                // Update UI
                document.getElementById('questionText').textContent = question.question;
                
                const optionsContainer = document.getElementById('optionsContainer');
                optionsContainer.innerHTML = '';
                
                ['A', 'B', 'C', 'D'].forEach((letter, index) => {
                    const optionBtn = document.createElement('button');
                    optionBtn.className = 'option-btn';
                    if (this.userAnswers[this.currentQuestionIndex] === index) {
                        optionBtn.classList.add('selected');
                    }
                    
                    optionBtn.innerHTML = `
                        <div class="option-letter">${letter}</div>
                        <div>${question.options[index] || `Option ${letter}`}</div>
                    `;
                    
                    optionBtn.onclick = () => this.selectOption(index);
                    optionsContainer.appendChild(optionBtn);
                });
                
                // Update navigation buttons
                this.updateNavigation();
            },
            
            selectOption(optionIndex) {
                this.userAnswers[this.currentQuestionIndex] = optionIndex;
                
                // Update UI
                const options = document.querySelectorAll('.option-btn');
                options.forEach((btn, index) => {
                    btn.classList.remove('selected');
                    if (index === optionIndex) {
                        btn.classList.add('selected');
                    }
                });
                
                // Update answered count
                this.updateTestInfo();
            },
            
            markForReview() {
                const index = this.currentQuestionIndex;
                if (this.markedQuestions.includes(index)) {
                    this.markedQuestions = this.markedQuestions.filter(i => i !== index);
                    this.showToast('Question unmarked', 'info');
                } else {
                    this.markedQuestions.push(index);
                    this.showToast('Question marked for review', 'warning');
                }
                this.updateReviewPanel();
            },
            
            nextQuestion() {
                if (this.currentQuestionIndex < this.userAnswers.length - 1) {
                    this.currentQuestionIndex++;
                    this.loadCurrentQuestion();
                }
            },
            
            prevQuestion() {
                if (this.currentQuestionIndex > 0) {
                    this.currentQuestionIndex--;
                    this.loadCurrentQuestion();
                }
            },
            
            nextSection() {
                if (this.currentSectionIndex < this.sections.length - 1) {
                    this.currentSectionIndex++;
                    this.currentQuestionIndex = this.sections[this.currentSectionIndex].startIndex;
                    this.loadCurrentQuestion();
                }
            },
            
            updateNavigation() {
                // Update section navigation highlights
                document.querySelectorAll('.section-btn').forEach((btn, index) => {
                    btn.classList.remove('active');
                    if (index === this.currentSectionIndex) {
                        btn.classList.add('active');
                    }
                });
                
                // Update question number display
                const currentSection = this.sections[this.currentSectionIndex];
                const questionInSection = this.currentQuestionIndex - currentSection.startIndex + 1;
                document.getElementById('currentSection').textContent = 
                    `${this.currentSectionIndex + 1} of ${this.sections.length}`;
            },
            
            createSectionNavigation() {
                const container = document.getElementById('sectionNavigation');
                container.innerHTML = '';
                
                this.sections.forEach((section, index) => {
                    const btn = document.createElement('button');
                    btn.className = 'section-btn';
                    btn.textContent = `Section ${index + 1}: ${section.name}`;
                    btn.onclick = () => {
                        this.currentSectionIndex = index;
                        this.currentQuestionIndex = section.startIndex;
                        this.loadCurrentQuestion();
                    };
                    container.appendChild(btn);
                });
            },
            
            startTimer() {
                if (this.timer) clearInterval(this.timer);
                
                this.timer = setInterval(() => {
                    this.timeRemaining--;
                    
                    const hours = Math.floor(this.timeRemaining / 3600);
                    const minutes = Math.floor((this.timeRemaining % 3600) / 60);
                    const seconds = this.timeRemaining % 60;
                    
                    document.getElementById('fullTestTimer').textContent = 
                        `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                    
                    if (this.timeRemaining <= 0) {
                        clearInterval(this.timer);
                        this.submitFullTest();
                    }
                }, 1000);
            },
            
            updateTestInfo() {
                const answered = this.userAnswers.filter(a => a !== null).length;
                document.getElementById('answeredCount').textContent = answered;
                document.getElementById('totalTestQuestions').textContent = this.userAnswers.length;
                document.getElementById('currentTestSubject').textContent = 
                    this.sections[this.currentSectionIndex]?.name || "Multiple Subjects";
            },
            
            showReviewPanel() {
                const panel = document.getElementById('reviewPanel');
                panel.style.display = panel.style.display === 'block' ? 'none' : 'block';
                this.updateReviewPanel();
            },
            
            updateReviewPanel() {
                const grid = document.getElementById('reviewGrid');
                grid.innerHTML = '';
                
                for (let i = 0; i < this.userAnswers.length; i++) {
                    const btn = document.createElement('button');
                    btn.className = 'review-btn';
                    btn.textContent = i + 1;
                    
                    if (i === this.currentQuestionIndex) {
                        btn.classList.add('current');
                    } else if (this.markedQuestions.includes(i)) {
                        btn.classList.add('marked');
                    } else if (this.userAnswers[i] !== null) {
                        btn.classList.add('answered');
                    } else {
                        btn.classList.add('unanswered');
                    }
                    
                    btn.onclick = () => {
                        this.currentQuestionIndex = i;
                        this.loadCurrentQuestion();
                        this.showReviewPanel();
                    };
                    
                    grid.appendChild(btn);
                }
            },
            
            submitFullTest() {
                clearInterval(this.timer);
                
                // Calculate score
                let correct = 0;
                let total = 0;
                
                this.sections.forEach(section => {
                    section.questions.forEach((question, index) => {
                        total++;
                        const answerIndex = this.userAnswers[section.startIndex + index];
                        if (answerIndex === question.correct) {
                            correct++;
                        }
                    });
                });
                
                const score = (correct / total) * 100;
                
                // Save result
                const studentName = prompt("Enter your name for the certificate:", "Student");
                const testId = `TEST${Date.now().toString().slice(-6)}`;
                
                const result = {
                    studentName: studentName || "Anonymous Student",
                    score: Math.round(score),
                    testId: testId,
                    date: new Date().toLocaleString(),
                    sections: this.sections.length,
                    questions: total,
                    correct: correct,
                    timeSpent: (this.timeRemaining > 0) ? 
                        `Used ${Math.floor((this.sections.length * 60 * 60 - this.timeRemaining) / 60)} minutes` : 
                        "Completed"
                };
                
                // Add to school results
                SchoolMode.testResults.push(result);
                SchoolMode.saveSchoolData();
                
                // Show certificate
                SchoolMode.generateCertificate(result.studentName, result.score, testId);
                
                // Show success message
                this.showToast(`Test submitted! Score: ${result.score}%`, 'success');
                
                // Return to main interface
                setTimeout(() => {
                    document.getElementById('comprehensiveTest').style.display = 'none';
                    document.getElementById('appInterface').style.display = 'block';
                    SchoolMode.updateAnalytics();
                }, 3000);
            },
            
            showToast(message, type = 'info') {
                const toast = document.createElement('div');
                toast.textContent = message;
                toast.style.cssText = `
                    position: fixed;
                    bottom: 20px;
                    left: 50%;
                    transform: translateX(-50%);
                    background: ${type === 'success' ? '#28a745' : type === 'error' ? '#d9534f' : '#004a99'};
                    color: white;
                    padding: 12px 24px;
                    border-radius: 8px;
                    z-index: 10000;
                    font-weight: 600;
                    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                `;
                document.body.appendChild(toast);
                setTimeout(() => toast.remove(), 3000);
            }
        };

        // ============================================
        // INITIALIZE EVERYTHING
        // ============================================
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize School Mode
            SchoolMode.init();
            
            // Initialize the rest of the app
            // ... (your existing initialization code)
        });

        // Force HTTPS for GitHub Pages
        if (window.location.protocol === 'http:' && 
            window.location.hostname.includes('github.io')) {
            window.location.href = window.location.href.replace('http:', 'https:');
        }
    </script>
</body>
</html>
